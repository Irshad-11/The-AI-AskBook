{% load static tailwind_tags %}

<!doctype html>
<html class="dark">
<head>
  <title>
    {% if mode == "create" %}Create{% else %}Edit{% endif %} Post
  </title>
  {% tailwind_css %}
</head>

<body class="bg-black text-slate-200 font-mono">

<div class="max-w-4xl mx-auto py-14 px-6 space-y-10">

  <!-- HEADER -->
  <div>
    <h1 class="text-3xl font-extrabold tracking-tight">
      {% if mode == "create" %}Create Post{% else %}Edit Post{% endif %}
    </h1>
    <p class="text-sm text-slate-400 mt-1">
      {% if mode == "create" %}
        Draft your idea before publishing
      {% else %}
        Editing: <span class="italic">{{ form.instance.title }}</span>
      {% endif %}
    </p>
  </div>

  <form method="post" class="space-y-10">
    {% csrf_token %}

    <!-- CORE CONTENT -->
    <section class="space-y-6 border border-slate-800 rounded-2xl p-6 bg-[#0b0f14]">
      <h2 class="text-sm uppercase tracking-widest text-slate-400">
        Core Content
      </h2>

      <div>
        <label class="text-xs text-slate-400">Title</label>
        {{ form.title }}
      </div>

      <div>
        <label class="text-xs text-slate-400">Summary</label>
        {{ form.summary }}
      </div>

      <div>
        <label class="text-xs text-slate-400">Prompt Text</label>
        {{ form.prompt_text }}
      </div>

      <div>
        <label class="text-xs text-slate-400">
          Description (Markdown)
        </label>
        {{ form.description_md }}
      </div>
    </section>

    <!-- METADATA -->
    <section class="space-y-6 border border-slate-800 rounded-2xl p-6 bg-[#0b0f14]">
      <h2 class="text-sm uppercase tracking-widest text-slate-400">
        Metadata
      </h2>

      <div>
        <label class="text-xs text-slate-400">Tags</label>
        {{ form.tags }}
      </div>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
        <div>
          <label class="text-xs text-slate-400">Difficulty</label>
          {{ form.difficulty_level }}
        </div>

        <div>
          <label class="text-xs text-slate-400">AI Model</label>
          {{ form.ai_model }}
        </div>
      </div>

      <div class="flex items-center gap-3">
        {{ form.is_public }}
        <span class="text-sm text-slate-400">
          Publicly visible
        </span>
      </div>
    </section>

    <!-- ADMIN / MODERATION -->
    {% if user.is_staff or user.is_superuser %}
    <section class="space-y-6 border border-red-500/30 rounded-2xl p-6 bg-[#120606]">
      <h2 class="text-sm uppercase tracking-widest text-red-400">
        Moderation Controls
      </h2>

      <div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
        <div>
          <label class="text-xs text-slate-400">Status</label>
          {{ form.status }}
        </div>

        <div class="flex items-center gap-3 mt-6">
          {{ form.is_featured }}
          <span class="text-sm text-slate-400">
            Featured Post
          </span>
        </div>
      </div>

      <div>
        <label class="text-xs text-slate-400">
          Rejection Reason (only if rejected)
        </label>
        {{ form.rejection_reason }}
      </div>

      <div>
        <label class="text-xs text-slate-400">
          Published At
        </label>
        {{ form.published_at }}
      </div>
    </section>
    {% endif %}

    <!-- ACTIONS -->
    <div class="flex justify-between items-center pt-6 border-t border-slate-800">

      <p class="text-xs text-slate-500">
        Created {{ form.instance.created_at|default:"â€”" }}
      </p>

      <button
        class="px-8 py-3 rounded-xl font-bold bg-indigo-600 hover:bg-indigo-500 transition"
      >
        {% if mode == "create" %}Create Post{% else %}Save Changes{% endif %}
      </button>

    </div>

  </form>
</div>

</body>
</html>
